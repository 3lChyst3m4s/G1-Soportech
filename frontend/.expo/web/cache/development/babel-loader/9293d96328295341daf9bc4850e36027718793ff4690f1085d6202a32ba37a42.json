{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport View from \"react-native-web/dist/exports/View\";\nimport styles from \"./styles\";\nimport { UserMessage } from \"../../../../components/UserMessage\";\nimport { MessageInput } from \"../MessageInput\";\nimport { Button } from \"../../../../components/Button\";\nimport { Alert } from \"../../../../components/Pop-up/Alert\";\nimport { useAuth } from \"../../../../context/AuthContext\";\nimport { useRequest } from \"../../../../context/RequestContext\";\nimport { useAlert } from \"../../../../context/AlertContext\";\nimport { closeRequest } from \"../../utils/closeCase\";\nimport { getMessages } from \"../../../../Api\";\nimport { useNavigation } from '@react-navigation/native';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar LogContainer = function LogContainer(_ref) {\n  var _ref2, _ref4;\n  var itemId = _ref.itemId;\n  var navigation = useNavigation();\n  var _useAuth = useAuth(),\n    user = _useAuth.user;\n  var _useRequest = useRequest(),\n    log = _useRequest.log,\n    request = _useRequest.request;\n  var _useAlert = useAlert(),\n    showAlert = _useAlert.showAlert;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    messages = _useState2[0],\n    setMessages = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    refreshing = _useState4[0],\n    setRefreshing = _useState4[1];\n  var flatListRef = useRef(null);\n  var loadMessages = function loadMessages() {\n    return (_ref2 = _ref2 || _asyncToGenerator(function* () {\n      var res = yield getMessages(itemId);\n      var data = yield res.data;\n      setMessages(data);\n    })).apply(this, arguments);\n  };\n  var renderMessage = function renderMessage(_ref3) {\n    var item = _ref3.item;\n    return _jsx(UserMessage, {\n      userId: item.userId,\n      content: item.content,\n      sentTime: item.sentTime,\n      local: item.userId === user.userId\n    });\n  };\n  var closeCase = function closeCase() {\n    return (_ref4 = _ref4 || _asyncToGenerator(function* () {\n      yield closeRequest({\n        requestId: itemId\n      });\n      navigation.push('Home');\n    })).apply(this, arguments);\n  };\n  useEffect(function () {\n    loadMessages();\n  }, [messages]);\n  var onRefresh = useCallback(_asyncToGenerator(function* () {\n    setRefreshing(true);\n    yield loadMessages();\n    setRefreshing(false);\n  }), []);\n  return _jsxs(View, {\n    style: {\n      flex: 1\n    },\n    children: [_jsxs(View, {\n      style: styles.logContainer,\n      children: [_jsx(View, {\n        style: styles.messageContainer,\n        children: _jsx(FlatList, {\n          ref: flatListRef,\n          data: messages,\n          keyExtractor: function keyExtractor(item) {\n            return item.messageId + '';\n          },\n          renderItem: renderMessage,\n          onContentSizeChange: function onContentSizeChange() {\n            return flatListRef.current.scrollToEnd({\n              animated: false\n            });\n          },\n          refreshControl: _jsx(RefreshControl, {\n            refreshing: refreshing,\n            onRefresh: onRefresh\n          })\n        })\n      }), request.conditionId === 1 && request.stateId == 2 && _jsxs(_Fragment, {\n        children: [_jsx(MessageInput, {\n          logId: log.logId\n        }), _jsx(Button, {\n          text: 'Resolver',\n          onPress: closeCase,\n          buttonStyle: styles.button,\n          color: 'blue'\n        })]\n      })]\n    }), _jsx(Alert, {})]\n  });\n};\nexport default LogContainer;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","FlatList","RefreshControl","View","styles","UserMessage","MessageInput","Button","Alert","useAuth","useRequest","useAlert","closeRequest","getMessages","useNavigation","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","LogContainer","_ref","_ref2","_ref4","itemId","navigation","_useAuth","user","_useRequest","log","request","_useAlert","showAlert","_useState","_useState2","_slicedToArray","messages","setMessages","_useState3","_useState4","refreshing","setRefreshing","flatListRef","loadMessages","_asyncToGenerator","res","data","apply","arguments","renderMessage","_ref3","item","userId","content","sentTime","local","closeCase","requestId","push","onRefresh","style","flex","children","logContainer","messageContainer","ref","keyExtractor","messageId","renderItem","onContentSizeChange","current","scrollToEnd","animated","refreshControl","conditionId","stateId","logId","text","onPress","buttonStyle","button","color"],"sources":["C:/Users/Mauro Retuerto/Desktop/Mauro/FISI/CICLO 8/Moviles/G1-Soportech/Test/frontend/users/solver/components/LogContainer/LogContainer.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport { FlatList, RefreshControl, View } from 'react-native'\r\n\r\nimport styles from './styles';\r\nimport { UserMessage } from '../../../../components/UserMessage';\r\nimport { MessageInput } from '../MessageInput';\r\nimport { Button } from '../../../../components/Button';\r\nimport { Alert } from '../../../../components/Pop-up/Alert';\r\n\r\nimport { useAuth } from '../../../../context/AuthContext';\r\nimport { useRequest } from '../../../../context/RequestContext';\r\nimport { useAlert } from '../../../../context/AlertContext';\r\n\r\nimport { closeRequest } from '../../utils/closeCase';\r\nimport { getMessages } from '../../../../Api';\r\n\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nconst LogContainer = ({ itemId }) => {\r\n  const navigation = useNavigation();\r\n  const { user } = useAuth();\r\n  const { log, request } = useRequest();\r\n  const { showAlert } = useAlert();\r\n  const [messages, setMessages] = useState([]);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const flatListRef = useRef(null);\r\n\r\n  const loadMessages = async () => {\r\n    const res = await getMessages(itemId);\r\n    const data = await res.data;\r\n    setMessages(data);\r\n  }\r\n\r\n  const renderMessage = ({ item }) => {\r\n    return <UserMessage userId={item.userId} content={item.content} sentTime={item.sentTime} local={item.userId === user.userId}/>\r\n  };\r\n\r\n  const closeCase = async () => {\r\n    await closeRequest({ requestId: itemId });\r\n    navigation.push('Home');\r\n  }\r\n\r\n  useEffect(() => {\r\n    loadMessages();\r\n  }, [messages]);\r\n\r\n  const onRefresh = useCallback(async () => {\r\n    setRefreshing(true);\r\n    await loadMessages();\r\n    setRefreshing(false);\r\n  }, []);\r\n\r\n  return (\r\n    <View style={{flex: 1}}>\r\n      <View style={styles.logContainer}>\r\n        <View style={styles.messageContainer}>\r\n          <FlatList\r\n            ref={flatListRef}\r\n            data={messages}\r\n            keyExtractor={(item) => item.messageId + ''}\r\n            renderItem={renderMessage}\r\n            onContentSizeChange={() => flatListRef.current.scrollToEnd({ animated: false })}\r\n            refreshControl={\r\n              <RefreshControl\r\n                refreshing={refreshing}\r\n                onRefresh={onRefresh}\r\n              />\r\n            }\r\n          />\r\n        </View>  \r\n        { request.conditionId === 1 && request.stateId == 2 && (\r\n        <>\r\n        <MessageInput \r\n          logId={log.logId}\r\n        />\r\n\r\n        \r\n        <Button\r\n        text={'Resolver'}\r\n        onPress={closeCase}\r\n        buttonStyle={styles.button}\r\n        color={'blue'}\r\n       />\r\n</>\r\n\r\n      )}\r\n      </View>\r\n\r\n      <Alert />\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default LogContainer"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,EAAEC,WAAW,QAAQ,OAAO;AAAA,OAAAC,QAAA;AAAA,OAAAC,cAAA;AAAA,OAAAC,IAAA;AAGvE,OAAOC,MAAM;AACb,SAASC,WAAW;AACpB,SAASC,YAAY;AACrB,SAASC,MAAM;AACf,SAASC,KAAK;AAEd,SAASC,OAAO;AAChB,SAASC,UAAU;AACnB,SAASC,QAAQ;AAEjB,SAASC,YAAY;AACrB,SAASC,WAAW;AAEpB,SAASC,aAAa,QAAQ,0BAA0B;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAEzD,IAAMC,YAAY,GAAG,SAAfA,YAAYA,CAAAC,IAAA,EAAmB;EAAA,IAAAC,KAAA,EAAAC,KAAA;EAAA,IAAbC,MAAM,GAAAH,IAAA,CAANG,MAAM;EAC5B,IAAMC,UAAU,GAAGZ,aAAa,CAAC,CAAC;EAClC,IAAAa,QAAA,GAAiBlB,OAAO,CAAC,CAAC;IAAlBmB,IAAI,GAAAD,QAAA,CAAJC,IAAI;EACZ,IAAAC,WAAA,GAAyBnB,UAAU,CAAC,CAAC;IAA7BoB,GAAG,GAAAD,WAAA,CAAHC,GAAG;IAAEC,OAAO,GAAAF,WAAA,CAAPE,OAAO;EACpB,IAAAC,SAAA,GAAsBrB,QAAQ,CAAC,CAAC;IAAxBsB,SAAS,GAAAD,SAAA,CAATC,SAAS;EACjB,IAAAC,SAAA,GAAgCrC,QAAQ,CAAC,EAAE,CAAC;IAAAsC,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAArCG,QAAQ,GAAAF,UAAA;IAAEG,WAAW,GAAAH,UAAA;EAC5B,IAAAI,UAAA,GAAoC1C,QAAQ,CAAC,KAAK,CAAC;IAAA2C,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAA5CE,UAAU,GAAAD,UAAA;IAAEE,aAAa,GAAAF,UAAA;EAChC,IAAMG,WAAW,GAAG5C,MAAM,CAAC,IAAI,CAAC;EAEhC,IAAM6C,YAAY,YAAZA,YAAYA,CAAA;IAAA,QAAArB,KAAA,GAAAA,KAAA,IAAAsB,iBAAA,CAAG,aAAY;MAC/B,IAAMC,GAAG,SAASjC,WAAW,CAACY,MAAM,CAAC;MACrC,IAAMsB,IAAI,SAASD,GAAG,CAACC,IAAI;MAC3BT,WAAW,CAACS,IAAI,CAAC;IACnB,CAAC,GAAAC,KAAA,OAAAC,SAAA;EAAA;EAED,IAAMC,aAAa,GAAG,SAAhBA,aAAaA,CAAAC,KAAA,EAAiB;IAAA,IAAXC,IAAI,GAAAD,KAAA,CAAJC,IAAI;IAC3B,OAAOpC,IAAA,CAACX,WAAW;MAACgD,MAAM,EAAED,IAAI,CAACC,MAAO;MAACC,OAAO,EAAEF,IAAI,CAACE,OAAQ;MAACC,QAAQ,EAAEH,IAAI,CAACG,QAAS;MAACC,KAAK,EAAEJ,IAAI,CAACC,MAAM,KAAKzB,IAAI,CAACyB;IAAO,CAAC,CAAC;EAChI,CAAC;EAED,IAAMI,SAAS,YAATA,SAASA,CAAA;IAAA,QAAAjC,KAAA,GAAAA,KAAA,IAAAqB,iBAAA,CAAG,aAAY;MAC5B,MAAMjC,YAAY,CAAC;QAAE8C,SAAS,EAAEjC;MAAO,CAAC,CAAC;MACzCC,UAAU,CAACiC,IAAI,CAAC,MAAM,CAAC;IACzB,CAAC,GAAAX,KAAA,OAAAC,SAAA;EAAA;EAEDnD,SAAS,CAAC,YAAM;IACd8C,YAAY,CAAC,CAAC;EAChB,CAAC,EAAE,CAACP,QAAQ,CAAC,CAAC;EAEd,IAAMuB,SAAS,GAAG5D,WAAW,CAAA6C,iBAAA,CAAC,aAAY;IACxCH,aAAa,CAAC,IAAI,CAAC;IACnB,MAAME,YAAY,CAAC,CAAC;IACpBF,aAAa,CAAC,KAAK,CAAC;EACtB,CAAC,GAAE,EAAE,CAAC;EAEN,OACEtB,KAAA,CAACjB,IAAI;IAAC0D,KAAK,EAAE;MAACC,IAAI,EAAE;IAAC,CAAE;IAAAC,QAAA,GACrB3C,KAAA,CAACjB,IAAI;MAAC0D,KAAK,EAAEzD,MAAM,CAAC4D,YAAa;MAAAD,QAAA,GAC/B/C,IAAA,CAACb,IAAI;QAAC0D,KAAK,EAAEzD,MAAM,CAAC6D,gBAAiB;QAAAF,QAAA,EACnC/C,IAAA,CAACf,QAAQ;UACPiE,GAAG,EAAEvB,WAAY;UACjBI,IAAI,EAAEV,QAAS;UACf8B,YAAY,EAAE,SAAAA,aAACf,IAAI;YAAA,OAAKA,IAAI,CAACgB,SAAS,GAAG,EAAE;UAAA,CAAC;UAC5CC,UAAU,EAAEnB,aAAc;UAC1BoB,mBAAmB,EAAE,SAAAA,oBAAA;YAAA,OAAM3B,WAAW,CAAC4B,OAAO,CAACC,WAAW,CAAC;cAAEC,QAAQ,EAAE;YAAM,CAAC,CAAC;UAAA,CAAC;UAChFC,cAAc,EACZ1D,IAAA,CAACd,cAAc;YACbuC,UAAU,EAAEA,UAAW;YACvBmB,SAAS,EAAEA;UAAU,CACtB;QACF,CACF;MAAC,CACE,CAAC,EACL7B,OAAO,CAAC4C,WAAW,KAAK,CAAC,IAAI5C,OAAO,CAAC6C,OAAO,IAAI,CAAC,IACnDxD,KAAA,CAAAF,SAAA;QAAA6C,QAAA,GACA/C,IAAA,CAACV,YAAY;UACXuE,KAAK,EAAE/C,GAAG,CAAC+C;QAAM,CAClB,CAAC,EAGF7D,IAAA,CAACT,MAAM;UACPuE,IAAI,EAAE,UAAW;UACjBC,OAAO,EAAEtB,SAAU;UACnBuB,WAAW,EAAE5E,MAAM,CAAC6E,MAAO;UAC3BC,KAAK,EAAE;QAAO,CACd,CAAC;MAAA,CACP,CAEK;IAAA,CACK,CAAC,EAEPlE,IAAA,CAACR,KAAK,IAAE,CAAC;EAAA,CACL,CAAC;AAEX,CAAC;AAED,eAAea,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}